<html>
<head>
 <link href="../style.css" rel="stylesheet" type="text/css">
</head>
<body>
<h3><font color="blue"><b>[TWIG]</b></font> Шаблон news.categories.tpl</h3>
<br/>
Данный шаблон используется для удобной генерации меню категорий (при его отсутствии будет использоваться старый шаблон <a href="categories.tpl.html">categories.tpl</a>).<br/>
В отличии от старого варианта, этот шаблон отвечает за генерацию полного меню, а не строки меню.<br/>
<br/>

<h3>Доступные переменные</h3>
Переменные:
<ul>
 <li><b>entries</b> - массив категорий, каждый элемент массива содержит данные по одной категории:
 	<ul>
 		<li><b>id</b> - ID категории</li>
 		<li><b>cat</b> - наименование категории</li>
 		<li><b>link</b> - ссылка для перехода в категорию</li>
 		<li><b>mark</b> - маркер для категории данного уровня (берётся из variables.ini - блок <b>[category_tree]</b>, параметр <b>mark.level.<УРОВЕНЬ></b>, а при отсутствии - <b>mark.default</b>)</li>
 		<li><b>level</b> - уровень вложенности категории (0 - в корне)</li>
 		<li><b>counter</b> - кол-во постов в категории</li>
 		<li><b>icon</b> - ссылка на иконку категории</li>
		<li><b>closeToLevel</b> - переменная определена если данная категория закрывает собой какой-либо уровень вложенности, переменная содержит уровень <u>к которому</u> закрывается данная категория</li>
 		<li><b>flags</b> - блок переменных-флагов:
 			<ul>
 				<li><b>active</b> - принимает значение `true` (1) в случае, если сейчас пользователь находится именно в этой категории</li>
 				<li><b>counter</b> - принимает значение `true` (1) в случае, если в настройке CMS разрешено отображение счетчика новостей в категории</li>
 				<li><b>hasChildren</b> - принимает значение `true` (1) в случае, если у данной категории есть подкатегории</li>
 				<li><b>closeLevel_<i>X</i></b> - принимает значение `true` (1) в случае, если данная категория закрывает собой уровень вложенности `<u><i>X</i></u>`</li>
			</ul>

		</li>
	</ul>

 </li>
</ul>

<br/>
<br/>
<h3>Совместимость со старым шаблонизатором</h3>
<p>Далеко не всем нравится синтаксис TWIG, поэтому для наиболее сложных в восприятии созданы элементы-синонимы.</p>
<ul>
	<li><b>[entries]</b>..<b>[/entries]</b> - повторяющийся блок (для каждой категории)</li>
	<li><b>[flags.active]</b>..<b>[/flags.active]</b> - условный блок, содержимое активно если пользователь сейчас находится в этой категории</li>
	<li><b>[!flags.active]</b>..<b>[/!flags.active]</b> - условный блок, содержимое активно если пользователь сейчас не находится в этой категории</li>
	<li><b>[flags.counter]</b>..<b>[/flags.counter]</b> - условный блок, содержимое активно если в настройке CMS разрешено отображение счетчика новостей в категории</li>
</ul>
<br/>
<br/>

<h3>Пример заполнения шаблона</h3>
<br/>
<div class="pre">
<pre>
Меню категорий:<br/>
{% for entry in entries %}
	&lt;!-- Выводим маркер категории --&gt;
	{{ entry.mark }}

	&lt;!-- Если не стоит флаг `flags.active`, т.е. если эта категория - не текущая, то показываем ссылку --&gt;
	&lt;!-- В текущей категории показываем имя категории жирным шрифтом --&gt;
	{% if (not entry.flags.active) %}
		&lt;a href="{{ entry.link }}">
	{% else %}
		&lt;b>
	{% endif %}
	{{ entry.cat }}
	{% if (entry.flags.active) %}
		&lt;/a>
	{% else %}
		&lt;/b>
	{% endif %}

	&lt;!-- Отображаем кол-во новостей в категории только в случае, если выставлен флаг `flags.counter` --&gt;
	{% if (entry.flags.counter) %}
		[ {{ entry.counter }}]
	{% endif %}
{% endfor %}
</pre>
</div>
<br/>
<br/>
<h3>Пример заполнения шаблона с вложенными уровнями через &lt;ul&gt;..&lt;/ul&gt;</h3>
<br/>
<div class="pre">
<pre>
Меню категорий:<br/>
<ul>
{% for entry in entries %}
	&lt;!-- Если не стоит флаг `flags.active`, т.е. если эта категория - не текущая, то показываем ссылку --&gt;
	&lt;!-- В текущей категории показываем имя категории жирным шрифтом --&gt;
	&lt;li&gt;
	{% if (not entry.flags.active) %}
		&lt;a href="{{ entry.link }}">
	{% else %}
		&lt;b>
	{% endif %}
	{{ entry.cat }}
	{% if (entry.flags.active) %}
		&lt;/a>
	{% else %}
		&lt;/b>
	{% endif %}

	&lt;!-- Отображаем кол-во новостей в категории только в случае, если выставлен флаг `flags.counter` --&gt;
	{% if (entry.flags.counter) %}
		[ {{ entry.counter }}]
	{% endif %}


	&lt;!-- Если у категории есть подкатегории, то открываем новый уровень вложенности --&gt;
	{% if (entry.flags.hasChildren) %}
		&lt;ul&gt;
	{% else %}
	&lt;/li&gt;
		&lt;!-- Если после этой категории закрывается 1 или несколько уровней - выводим закрывающиеся &lt;/ul&gt; --&gt;
		{% if isSet(entry.closeToLevel) %}
		{% for i in entry.closeToLevel .. entry.level %}
			&lt;/ul&gt;&lt;/li&gt;
		{% endfor %}
	{% endif %}
{% endfor %}
</pre>
</div>
<br/>
<br/>


<h3>Пример заполнения шаблона / режим совместимости</h3>
<br/>
<div class="pre">
<pre>
Меню категорий:<br/>
[entries]
	&lt;!-- Выводим маркер категории --&gt;
	{{ entry.mark }}

	&lt;!-- Если не стоит флаг `flags.active`, т.е. если эта категория - не текущая, то показываем ссылку --&gt;
	&lt;!-- В текущей категории показываем имя категории жирным шрифтом --&gt;
	[!flags.active]&lt;a href="{{ entry.link }}">[/!flags.active][flags.active]&lt;b>[/flags.active]{{ entry.cat }}[!flags.active]&lt;/a>[/!flags.active][flags.active]&lt;/b>[/flags.active]

	&lt;!-- Отображаем кол-во новостей в категории только в случае, если выставлен флаг `flags.counter` --&gt;
	[flags.counter][ {{ entry.counter }}][/flags.counter]
[/entries]
</pre>
</div>

</body>
</html>